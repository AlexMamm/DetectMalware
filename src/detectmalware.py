import argparse
import os
from models.train_model import learn
from models.predict_model import predict
from models.preprocessing import convert_to_png
from models.train_model import CNN
import warnings

def main():
    parser = argparse.ArgumentParser()
    subparsers = parser.add_subparsers(help='Commands')

    learn_parser = subparsers.add_parser('learn', help='Learn Model')
    learn_parser.set_defaults(which='learn')

    check_parser = subparsers.add_parser('predict', help='Predict Files')
    check_parser.set_defaults(which='predict')
    check_parser.add_argument('-p', '--path', action='store', help='Path file or directory for predict')

    args = parser.parse_args()

    print('Action: %s' % args.which)

    root = '/'.join(os.path.dirname(os.path.abspath(__file__)).split('/')[:-1])
    if args.which == 'learn':
        learn(root)
    elif args.which == 'predict':
        predict(root, args.path)
    else:
        print('[!] Invalid action')


if __name__ == '__main__':
    warnings.filterwarnings('ignore')
    main()